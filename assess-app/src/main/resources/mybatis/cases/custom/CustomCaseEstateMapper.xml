<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.copower.pmcc.assess.dal.cases.custom.mapper.CustomCaseEstateMapper">
    <resultMap id="BaseResultMap" type="com.copower.pmcc.assess.dal.cases.custom.entity.CustomCaseEstate">
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="name" property="name" jdbcType="VARCHAR"/>
        <result column="version" property="version" jdbcType="INTEGER"/>
    </resultMap>
    <select id="getCustomCaseEstateList" parameterType="map" resultMap="BaseResultMap">
        SELECT id,`name`,version FROM (
        SELECT DISTINCT id,`name`,version FROM tb_case_estate where 1=1
        <if test="name!=null and name!=''">
            AND `name` LIKE CONCAT(CONCAT('%', #{name}), '%')
        </if>
        <if test="province!=null and province!=''">
            AND province = #{province}
        </if>
        <if test="city!=null and city!=''">
            AND city = #{city}
        </if>
        <if test="district!=null and district!=''">
            AND district = #{district}
        </if>
        ORDER BY version DESC) AS T
        GROUP BY `name` ORDER BY version DESC,NAME
    </select>
</mapper>

